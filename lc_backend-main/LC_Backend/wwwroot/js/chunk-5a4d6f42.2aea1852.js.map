{"version":3,"sources":["webpack:///./src/views/Prescription/CreatePrescription.vue?179b","webpack:///./src/views/Prescription/CreatePrescription.vue","webpack:///./src/views/Prescription/CreatePrescription.vue?44d5"],"names":["class","_createElementVNode","for","type","disabled","_hoisted_26","_createElementBlock","_hoisted_1","_hoisted_2","$data","_hoisted_3","_Fragment","entry","item","key","onClick","$options","resource","code","coding","display","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","id","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","dosageInstruction","text","_hoisted_21","_hoisted_22","_hoisted_23","note","_hoisted_24","_hoisted_25","title","style","_hoisted_28","name","data","patientId","this","$route","params","dischargeSummaryId","dischargeId","patient","patientName","medications","selectedMedication","selectedMedicationStrength","medicationRequest","resourceType","status","intent","priority","medicationCodeableConcept","system","subject","supportingInformation","authoredOn","Date","requester","$getUserId","sequence","timing","repeat","frequency","period","periodUnit","beforeCreate","$redirectNotAuthorizedToLogin","mounted","console","log","fetch","$apiUrl","credentials","then","response","json","methods","updateSelectedMedication","medication","ingredient","strength","numerator","value","setPatientName","given","family","updateStatusOfCareplanActivity","searchedActivityCodePrescription","carePlan","activity","detail","reasonReference","dischargeReference","submitPrescription","saveAndCreateNewPrescription","JSON","stringify","postRequest","method","headers","body","async","ok","window","location","reload","href","error","message","Promise","reject","catch","__exports__","render"],"mappings":"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","file":"js/chunk-5a4d6f42.2aea1852.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./CreatePrescription.vue?vue&type=style&index=0&id=19892c10&scoped=true&lang=css\"","<script>\r\nexport default {\r\n    name: \"CreatePrescription\",\r\n    data() {\r\n        return {\r\n            patientId: this.$route.params.id,\r\n            dischargeSummaryId: this.$route.params.dischargeId,\r\n            patient: {},\r\n            patientName: \"\",\r\n            medications: [],\r\n            selectedMedication: {},\r\n            selectedMedicationStrength: \"\",\r\n            medicationRequest: {\r\n                //example https://hl7.org/fhir/medicationrequest0302.json.html\r\n                resourceType: \"MedicationRequest\",\r\n                status: \"active\",\r\n                intent: \"order\",\r\n                priority: \"asap\",\r\n                medicationCodeableConcept: {\r\n                    coding: [\r\n                        {\r\n                            system: \"\",\r\n                            code: \"\",\r\n                            display: \"\"\r\n                        }\r\n                    ]\r\n                },\r\n                subject: {\r\n                    id: \"\", // patienId\r\n                    display: \"\", // patientName\r\n                },\r\n                supportingInformation: [\r\n                    {\r\n                        id: \"\", // composition (linked discharge summary)\r\n                    },\r\n                ],\r\n                authoredOn: new Date(),\r\n                requester: {\r\n                    id: this.$getUserId(),\r\n                },\r\n                note: [\r\n                    {\r\n                        text: \"\",\r\n                    },\r\n                ],\r\n                dosageInstruction: [\r\n                    {\r\n                        sequence: 0,\r\n                        text: \"\",\r\n                        timing: {\r\n                            repeat: {\r\n                                frequency: 0,\r\n                                period: 0,\r\n                                periodUnit: \"d\",\r\n                            },\r\n                        },\r\n                    },\r\n                ],\r\n            },\r\n        };\r\n    },\r\n    beforeCreate() {\r\n        this.$redirectNotAuthorizedToLogin([2]);\r\n    },\r\n    mounted() {\r\n        console.log(this.patientId);\r\n        console.log(this.dischargeSummaryId);\r\n        fetch(`${this.$apiUrl}/Medication`, {\r\n            credentials: 'include',\r\n        })\r\n            .then((response) => response.json())\r\n            .then((data) => (this.medications = data));\r\n        fetch(`${this.$apiUrl}/Patient/${this.patientId}`, {\r\n            credentials: 'include',\r\n        })\r\n            .then((response) => response.json())\r\n            .then((data) => (this.patient = data));\r\n    },\r\n    methods: {\r\n        updateSelectedMedication(medication) {\r\n            console.log(medication);\r\n            this.selectedMedication = medication;\r\n            this.selectedMedicationStrength = medication.resource.ingredient != null ?\r\n                medication.resource.ingredient[0].strength.numerator.value + \" \" + medication.resource.ingredient[0].strength.numerator.code : \"\";\r\n        },\r\n        setPatientName() {\r\n            if (this.patient.id != null) {\r\n                this.patientName =\r\n                    this.patient.name[0].given[0] + \" \" + this.patient.name[0].family;\r\n                return true;\r\n            }\r\n        },\r\n        updateStatusOfCareplanActivity() {\r\n            console.log(\"UPDATE STATUS\");\r\n\r\n            const searchedActivityCodePrescription = \"16076005\";\r\n\r\n            fetch(`${this.$apiUrl}/CarePlan?subject=${this.patientId}&activity-code=${searchedActivityCodePrescription}`, {\r\n                credentials: 'include',\r\n            })\r\n                .then((response) => response.json())\r\n                .then(function (data) {\r\n                    for (const carePlan of data.entry) {\r\n                        if (carePlan.resource.activity == null) {\r\n                            console.log(\"[ERROR] carePlan.resource.activity == null\")\r\n                            continue\r\n                        }\r\n                        for (const activity of carePlan.resource.activity) {\r\n                            if (activity.detail.reasonReference == null) {\r\n                                console.log(\"[ERROR] activity.detail == null\")\r\n                                continue\r\n                            }\r\n                            for (const dischargeReference of activity.detail.reasonReference) {\r\n                                if (dischargeReference.id == this.dischargeSummaryId) {\r\n                                    activity.detail.status = \"prescription created\";\r\n                                    break;\r\n\r\n                                    //todo: update careplan in DB\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n        },\r\n        submitPrescription(saveAndCreateNewPrescription) {\r\n            if (\r\n                this.selectedMedication == null ||\r\n                this.selectedMedication.resource == null\r\n            ) {\r\n                return;\r\n            }\r\n            this.medicationRequest.medicationCodeableConcept.coding[0].code =\r\n                this.selectedMedication.resource.code.coding[0].code;\r\n            this.medicationRequest.medicationCodeableConcept.coding[0].display =\r\n                this.selectedMedication.resource.code.coding[0].display;\r\n            this.medicationRequest.medicationCodeableConcept.coding[0].system =\r\n                this.selectedMedication.resource.code.coding[0].system;\r\n            this.medicationRequest.subject.id = this.patientId;\r\n            this.medicationRequest.subject.display = this.patientName;\r\n            this.medicationRequest.supportingInformation[0].id = this.dischargeSummaryId;\r\n\r\n            console.log(JSON.stringify(this.medicationRequest));\r\n\r\n            const postRequest = {\r\n                method: \"POST\",\r\n                headers: { \"Content-Type\": \"application/json\" },\r\n                body: JSON.stringify(this.medicationRequest),\r\n                credentials: 'include',\r\n            };\r\n            fetch(\r\n                `${this.$apiUrl}/MedicationRequest`,\r\n                postRequest\r\n            )\r\n                .then(async (response) => {\r\n                    const data = await response.json();\r\n                    if (!response.ok) {\r\n                        const error = (data && data.message) || response.status;\r\n                        console.log(Promise.reject(error));\r\n                    } else if (data != null) {\r\n                        console.log(data);\r\n\r\n                        if (this.dischargeSummaryId != null) {\r\n                            //update careplan not working\r\n                            //this.updateStatusOfCareplanActivity(); \r\n                        }\r\n\r\n                        if (saveAndCreateNewPrescription) {\r\n                            window.location.reload();\r\n                        }\r\n                        else {\r\n                            window.location.href = \"/patient/\" + this.patientId;\r\n                        }\r\n                        //todo -> set careplan activity status to prescription created\r\n                    }\r\n                })\r\n                .catch((error) => {\r\n                    console.error(\"Error\", error);\r\n                });\r\n        }\r\n    },\r\n};\r\n</script>\r\n\r\n<template>\r\n    <div class=\"row\">\r\n        <div class=\"card card-body col-md-4\">\r\n            <ul v-if=\"medications != null && patient != null\" class=\"list-group\">\r\n                <li v-for=\"item in medications.entry\" :key=\"item\" @click=\"updateSelectedMedication(item)\"\r\n                    class=\"list-group-item\">\r\n                    {{ item.resource.code.coding[0].display }}\r\n                </li>\r\n            </ul>\r\n        </div>\r\n\r\n        <div class=\"col-md-7 offset-md-1\">\r\n            <div class=\"form-group row pb-1\">\r\n                <label for=\"patient\" class=\"col-sm-3 col-form-label\">Patient</label>\r\n                <div class=\"col-sm-9\">\r\n                    <input v-if=\"patient != null && setPatientName()\" v-model=\"patientName\" type=\"text\"\r\n                        class=\"form-control\" id=\"patient\" disabled />\r\n                    <input v-else type=\"text\" class=\"form-control\" disabled />\r\n                </div>\r\n            </div>\r\n            <div class=\"form-group row pb-1\">\r\n                <label for=\"medication\" class=\"col-sm-3 col-form-label\">Medikament</label>\r\n                <div class=\"col-sm-9\">\r\n                    <input v-if=\"selectedMedication.resource != null\"\r\n                        v-model=\"selectedMedication.resource.code.coding[0].display\" type=\"text\" class=\"form-control\"\r\n                        id=\"medication\" disabled />\r\n                    <input v-else type=\"text\" class=\"form-control\" disabled />\r\n                </div>\r\n            </div>\r\n            <div class=\"form-group row pb-1\">\r\n                <label for=\"code\" class=\"col-sm-3 col-form-label\">Code</label>\r\n                <div class=\"col-sm-9\">\r\n                    <input v-if=\"selectedMedication.resource != null\"\r\n                        v-model=\"selectedMedication.resource.code.coding[0].code\" type=\"text\" class=\"form-control\"\r\n                        id=\"code\" disabled />\r\n                    <input v-else type=\"text\" class=\"form-control\" disabled />\r\n                </div>\r\n            </div>\r\n            <div class=\"form-group row pb-1\">\r\n                <label for=\"intakeRule\" class=\"col-sm-3 col-form-label\">Einnahmeregel</label>\r\n                <div class=\"col-sm-9\">\r\n                    <input v-model=\"medicationRequest.dosageInstruction[0].text\" type=\"text\" class=\"form-control\"\r\n                        id=\"intakeRule\" />\r\n                </div>\r\n            </div>\r\n            <div class=\"form-group row pb-1\">\r\n                <label for=\"remark\" class=\"col-sm-3 col-form-label\">Anmerkung</label>\r\n                <div class=\"col-sm-9\">\r\n                    <textarea v-model=\"medicationRequest.note[0].text\" class=\"form-control\" id=\"remark\"></textarea>\r\n                </div>\r\n            </div>\r\n            <div class=\"form-group row pt-1\">\r\n                <div class=\"col-sm-1 offset-sm-8\">\r\n                    <button class=\"btn btn-success\" title=\"Speichern und zusätzliches Medikament hinzufügen\"\r\n                        @click=\"submitPrescription(true)\" style=\"width: 3em;\">\r\n                        <i class=\"fa fa-plus\"></i>\r\n                    </button>\r\n                </div>\r\n                <div class=\"col-sm-3\">\r\n                    <button class=\"btn btn-primary\" @click=\"submitPrescription(false)\">\r\n                        Rezept erstellen\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<style scoped>\r\nli:hover {\r\n    cursor: pointer;\r\n    background-color: #e3f2fd;\r\n}\r\n</style>\r\n","import { render } from \"./CreatePrescription.vue?vue&type=template&id=19892c10&scoped=true\"\nimport script from \"./CreatePrescription.vue?vue&type=script&lang=js\"\nexport * from \"./CreatePrescription.vue?vue&type=script&lang=js\"\n\nimport \"./CreatePrescription.vue?vue&type=style&index=0&id=19892c10&scoped=true&lang=css\"\n\nimport exportComponent from \"C:\\\\Dev\\\\Web\\\\FHTW-INNO-LinkedCareWebClient\\\\web-client\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-19892c10\"]])\n\nexport default __exports__"],"sourceRoot":""}
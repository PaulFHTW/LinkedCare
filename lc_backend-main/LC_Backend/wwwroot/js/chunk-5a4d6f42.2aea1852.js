(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a4d6f42"],{"62b9":function(e,t,i){"use strict";i("c92b")},c92b:function(e,t,i){},d1a1:function(e,t,i){"use strict";i.r(t);var c=i("7a23");const o=e=>(Object(c["w"])("data-v-19892c10"),e=e(),Object(c["u"])(),e),s={class:"row"},n={class:"card card-body col-md-4"},a={key:0,class:"list-group"},l=["onClick"],d={class:"col-md-7 offset-md-1"},r={class:"form-group row pb-1"},u=o(()=>Object(c["g"])("label",{for:"patient",class:"col-sm-3 col-form-label"},"Patient",-1)),m={class:"col-sm-9"},p={key:1,type:"text",class:"form-control",disabled:""},b={class:"form-group row pb-1"},g=o(()=>Object(c["g"])("label",{for:"medication",class:"col-sm-3 col-form-label"},"Medikament",-1)),f={class:"col-sm-9"},h={key:1,type:"text",class:"form-control",disabled:""},j={class:"form-group row pb-1"},O=o(()=>Object(c["g"])("label",{for:"code",class:"col-sm-3 col-form-label"},"Code",-1)),y={class:"col-sm-9"},v={key:1,type:"text",class:"form-control",disabled:""},R={class:"form-group row pb-1"},k=o(()=>Object(c["g"])("label",{for:"intakeRule",class:"col-sm-3 col-form-label"},"Einnahmeregel",-1)),M={class:"col-sm-9"},w={class:"form-group row pb-1"},I=o(()=>Object(c["g"])("label",{for:"remark",class:"col-sm-3 col-form-label"},"Anmerkung",-1)),q={class:"col-sm-9"},C={class:"form-group row pt-1"},S={class:"col-sm-1 offset-sm-8"},x=o(()=>Object(c["g"])("i",{class:"fa fa-plus"},null,-1)),P=[x],U={class:"col-sm-3"};function $(e,t,i,o,x,$){return Object(c["t"])(),Object(c["f"])("div",s,[Object(c["g"])("div",n,[null!=x.medications&&null!=x.patient?(Object(c["t"])(),Object(c["f"])("ul",a,[(Object(c["t"])(!0),Object(c["f"])(c["a"],null,Object(c["z"])(x.medications.entry,e=>(Object(c["t"])(),Object(c["f"])("li",{key:e,onClick:t=>$.updateSelectedMedication(e),class:"list-group-item"},Object(c["E"])(e.resource.code.coding[0].display),9,l))),128))])):Object(c["e"])("",!0)]),Object(c["g"])("div",d,[Object(c["g"])("div",r,[u,Object(c["g"])("div",m,[null!=x.patient&&$.setPatientName()?Object(c["J"])((Object(c["t"])(),Object(c["f"])("input",{key:0,"onUpdate:modelValue":t[0]||(t[0]=e=>x.patientName=e),type:"text",class:"form-control",id:"patient",disabled:""},null,512)),[[c["G"],x.patientName]]):(Object(c["t"])(),Object(c["f"])("input",p))])]),Object(c["g"])("div",b,[g,Object(c["g"])("div",f,[null!=x.selectedMedication.resource?Object(c["J"])((Object(c["t"])(),Object(c["f"])("input",{key:0,"onUpdate:modelValue":t[1]||(t[1]=e=>x.selectedMedication.resource.code.coding[0].display=e),type:"text",class:"form-control",id:"medication",disabled:""},null,512)),[[c["G"],x.selectedMedication.resource.code.coding[0].display]]):(Object(c["t"])(),Object(c["f"])("input",h))])]),Object(c["g"])("div",j,[O,Object(c["g"])("div",y,[null!=x.selectedMedication.resource?Object(c["J"])((Object(c["t"])(),Object(c["f"])("input",{key:0,"onUpdate:modelValue":t[2]||(t[2]=e=>x.selectedMedication.resource.code.coding[0].code=e),type:"text",class:"form-control",id:"code",disabled:""},null,512)),[[c["G"],x.selectedMedication.resource.code.coding[0].code]]):(Object(c["t"])(),Object(c["f"])("input",v))])]),Object(c["g"])("div",R,[k,Object(c["g"])("div",M,[Object(c["J"])(Object(c["g"])("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>x.medicationRequest.dosageInstruction[0].text=e),type:"text",class:"form-control",id:"intakeRule"},null,512),[[c["G"],x.medicationRequest.dosageInstruction[0].text]])])]),Object(c["g"])("div",w,[I,Object(c["g"])("div",q,[Object(c["J"])(Object(c["g"])("textarea",{"onUpdate:modelValue":t[4]||(t[4]=e=>x.medicationRequest.note[0].text=e),class:"form-control",id:"remark"},null,512),[[c["G"],x.medicationRequest.note[0].text]])])]),Object(c["g"])("div",C,[Object(c["g"])("div",S,[Object(c["g"])("button",{class:"btn btn-success",title:"Speichern und zusätzliches Medikament hinzufügen",onClick:t[5]||(t[5]=e=>$.submitPrescription(!0)),style:{width:"3em"}},P)]),Object(c["g"])("div",U,[Object(c["g"])("button",{class:"btn btn-primary",onClick:t[6]||(t[6]=e=>$.submitPrescription(!1))}," Rezept erstellen ")])])])])}var N={name:"CreatePrescription",data(){return{patientId:this.$route.params.id,dischargeSummaryId:this.$route.params.dischargeId,patient:{},patientName:"",medications:[],selectedMedication:{},selectedMedicationStrength:"",medicationRequest:{resourceType:"MedicationRequest",status:"active",intent:"order",priority:"asap",medicationCodeableConcept:{coding:[{system:"",code:"",display:""}]},subject:{id:"",display:""},supportingInformation:[{id:""}],authoredOn:new Date,requester:{id:this.$getUserId()},note:[{text:""}],dosageInstruction:[{sequence:0,text:"",timing:{repeat:{frequency:0,period:0,periodUnit:"d"}}}]}}},beforeCreate(){this.$redirectNotAuthorizedToLogin([2])},mounted(){console.log(this.patientId),console.log(this.dischargeSummaryId),fetch(this.$apiUrl+"/Medication",{credentials:"include"}).then(e=>e.json()).then(e=>this.medications=e),fetch(`${this.$apiUrl}/Patient/${this.patientId}`,{credentials:"include"}).then(e=>e.json()).then(e=>this.patient=e)},methods:{updateSelectedMedication(e){console.log(e),this.selectedMedication=e,this.selectedMedicationStrength=null!=e.resource.ingredient?e.resource.ingredient[0].strength.numerator.value+" "+e.resource.ingredient[0].strength.numerator.code:""},setPatientName(){if(null!=this.patient.id)return this.patientName=this.patient.name[0].given[0]+" "+this.patient.name[0].family,!0},updateStatusOfCareplanActivity(){console.log("UPDATE STATUS");const e="16076005";fetch(`${this.$apiUrl}/CarePlan?subject=${this.patientId}&activity-code=${e}`,{credentials:"include"}).then(e=>e.json()).then((function(e){for(const t of e.entry)if(null!=t.resource.activity)for(const e of t.resource.activity)if(null!=e.detail.reasonReference){for(const t of e.detail.reasonReference)if(t.id==this.dischargeSummaryId){e.detail.status="prescription created";break}}else console.log("[ERROR] activity.detail == null");else console.log("[ERROR] carePlan.resource.activity == null")}))},submitPrescription(e){if(null==this.selectedMedication||null==this.selectedMedication.resource)return;this.medicationRequest.medicationCodeableConcept.coding[0].code=this.selectedMedication.resource.code.coding[0].code,this.medicationRequest.medicationCodeableConcept.coding[0].display=this.selectedMedication.resource.code.coding[0].display,this.medicationRequest.medicationCodeableConcept.coding[0].system=this.selectedMedication.resource.code.coding[0].system,this.medicationRequest.subject.id=this.patientId,this.medicationRequest.subject.display=this.patientName,this.medicationRequest.supportingInformation[0].id=this.dischargeSummaryId,console.log(JSON.stringify(this.medicationRequest));const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.medicationRequest),credentials:"include"};fetch(this.$apiUrl+"/MedicationRequest",t).then(async t=>{const i=await t.json();if(t.ok)null!=i&&(console.log(i),this.dischargeSummaryId,e?window.location.reload():window.location.href="/patient/"+this.patientId);else{const e=i&&i.message||t.status;console.log(Promise.reject(e))}}).catch(e=>{console.error("Error",e)})}}},J=(i("62b9"),i("6b0d")),T=i.n(J);const z=T()(N,[["render",$],["__scopeId","data-v-19892c10"]]);t["default"]=z}}]);
//# sourceMappingURL=chunk-5a4d6f42.2aea1852.js.map